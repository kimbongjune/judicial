# 11. 화면 설계

## 1. 개요

### 1.1 기술 스택
| 구분 | 기술 | 용도 |
|------|------|------|
| 템플릿 엔진 | Jinja2 | 서버사이드 렌더링 |
| CSS | TailwindCSS 3.x | 스타일링 |
| JavaScript | Alpine.js 3.x | 클라이언트 상호작용 |

### 1.2 페이지 맵
```
/                           # 메인 (통합 검색)
├── /cases                  # 판례 목록
│   └── /cases/{id}         # 판례 상세
├── /constitutional         # 헌재결정례 목록
│   └── /constitutional/{id}# 헌재결정례 상세
├── /interpretations        # 법령해석례 목록
│   └── /interpretations/{id}# 법령해석례 상세
└── /similarity             # 유사 문서 검색 결과
```

### 1.3 URL 쿼리 파라미터
| 파라미터 | 타입 | 설명 | 예시 |
|----------|------|------|------|
| q | string | 검색어 | ?q=손해배상 |
| page | int | 페이지 번호 (1부터) | ?page=2 |
| size | int | 페이지당 항목 수 | ?size=20 |
| court | string | 법원 종류 | ?court=대법원 |
| case_type | string | 사건 종류 | ?case_type=민사 |
| date_from | string | 시작일 (YYYY-MM-DD) | ?date_from=2020-01-01 |
| date_to | string | 종료일 (YYYY-MM-DD) | ?date_to=2023-12-31 |

---

## 2. 공통 레이아웃 (base.html)

### 2.1 템플릿 코드
```html
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}법률 검색{% endblock %}</title>
    
    <!-- TailwindCSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Alpine.js -->
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    
    {% block head %}{% endblock %}
</head>
<body class="bg-gray-50 min-h-screen flex flex-col">
    <!-- 헤더 -->
    <header class="bg-white shadow-sm border-b" x-data="{ mobileMenuOpen: false }">
        <nav class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <!-- 로고 -->
                <div class="flex items-center">
                    <a href="/" class="text-xl font-bold text-blue-600">
                        법률검색
                    </a>
                </div>
                
                <!-- 데스크톱 네비게이션 -->
                <div class="hidden md:flex items-center space-x-8">
                    <a href="/cases" class="text-gray-700 hover:text-blue-600 
                        {% if request.url.path.startswith('/cases') %}text-blue-600 font-semibold{% endif %}">
                        판례
                    </a>
                    <a href="/constitutional" class="text-gray-700 hover:text-blue-600
                        {% if request.url.path.startswith('/constitutional') %}text-blue-600 font-semibold{% endif %}">
                        헌재결정례
                    </a>
                    <a href="/interpretations" class="text-gray-700 hover:text-blue-600
                        {% if request.url.path.startswith('/interpretations') %}text-blue-600 font-semibold{% endif %}">
                        법령해석례
                    </a>
                    <a href="/similarity" class="text-gray-700 hover:text-blue-600
                        {% if request.url.path.startswith('/similarity') %}text-blue-600 font-semibold{% endif %}">
                        유사검색
                    </a>
                </div>
                
                <!-- 모바일 메뉴 버튼 -->
                <div class="md:hidden flex items-center">
                    <button @click="mobileMenuOpen = !mobileMenuOpen" 
                            class="text-gray-700 hover:text-blue-600">
                        <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path x-show="!mobileMenuOpen" stroke-linecap="round" stroke-linejoin="round" 
                                  stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
                            <path x-show="mobileMenuOpen" stroke-linecap="round" stroke-linejoin="round" 
                                  stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                        </svg>
                    </button>
                </div>
            </div>
            
            <!-- 모바일 메뉴 -->
            <div x-show="mobileMenuOpen" x-cloak class="md:hidden pb-4">
                <a href="/cases" class="block py-2 text-gray-700 hover:text-blue-600">판례</a>
                <a href="/constitutional" class="block py-2 text-gray-700 hover:text-blue-600">헌재결정례</a>
                <a href="/interpretations" class="block py-2 text-gray-700 hover:text-blue-600">법령해석례</a>
                <a href="/similarity" class="block py-2 text-gray-700 hover:text-blue-600">유사검색</a>
            </div>
        </nav>
    </header>
    
    <!-- 메인 컨텐츠 -->
    <main class="flex-1">
        {% block content %}{% endblock %}
    </main>
    
    <!-- 푸터 -->
    <footer class="bg-gray-800 text-gray-300 py-8 mt-auto">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center">
                <p class="text-sm">
                    본 서비스는 법제처 국가법령정보 공동활용 Open API를 활용하여 제공됩니다.
                </p>
                <p class="text-xs mt-2 text-gray-500">
                    © 2024 법률검색. 판례 및 법령해석례의 저작권은 각 기관에 있습니다.
                </p>
            </div>
        </div>
    </footer>
    
    {% block scripts %}{% endblock %}
</body>
</html>
```

### 2.2 컨텍스트 변수
| 변수 | 타입 | 설명 |
|------|------|------|
| request | Request | FastAPI Request 객체 (URL 경로 확인용) |

---

## 3. 메인 페이지 (index.html)

### 3.1 템플릿 코드
```html
{% extends "base.html" %}

{% block title %}법률검색 - 판례, 헌재결정례, 법령해석례 통합 검색{% endblock %}

{% block content %}
<div class="max-w-4xl mx-auto px-4 py-16">
    <!-- 히어로 섹션 -->
    <div class="text-center mb-12">
        <h1 class="text-4xl font-bold text-gray-900 mb-4">
            법률 문서 통합 검색
        </h1>
        <p class="text-lg text-gray-600">
            판례, 헌재결정례, 법령해석례를 한 곳에서 검색하세요
        </p>
    </div>
    
    <!-- 통합 검색 폼 -->
    <form action="/search" method="GET" class="bg-white rounded-xl shadow-lg p-6">
        <!-- 검색 대상 선택 -->
        <div class="mb-4">
            <label class="block text-sm font-medium text-gray-700 mb-2">검색 대상</label>
            <div class="flex flex-wrap gap-4">
                <label class="inline-flex items-center">
                    <input type="radio" name="target" value="all" checked 
                           class="form-radio text-blue-600">
                    <span class="ml-2">전체</span>
                </label>
                <label class="inline-flex items-center">
                    <input type="radio" name="target" value="cases" 
                           class="form-radio text-blue-600">
                    <span class="ml-2">판례</span>
                </label>
                <label class="inline-flex items-center">
                    <input type="radio" name="target" value="constitutional" 
                           class="form-radio text-blue-600">
                    <span class="ml-2">헌재결정례</span>
                </label>
                <label class="inline-flex items-center">
                    <input type="radio" name="target" value="interpretations" 
                           class="form-radio text-blue-600">
                    <span class="ml-2">법령해석례</span>
                </label>
            </div>
        </div>
        
        <!-- 검색어 입력 -->
        <div class="flex gap-2">
            <input type="text" name="q" placeholder="검색어를 입력하세요" 
                   class="flex-1 px-4 py-3 border border-gray-300 rounded-lg 
                          focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                   required>
            <button type="submit" 
                    class="px-8 py-3 bg-blue-600 text-white rounded-lg 
                           hover:bg-blue-700 transition font-medium">
                검색
            </button>
        </div>
    </form>
    
    <!-- 바로가기 카드 -->
    <div class="grid md:grid-cols-3 gap-6 mt-12">
        <!-- 판례 카드 -->
        <a href="/cases" class="bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition">
            <div class="text-blue-600 mb-3">
                <svg class="w-10 h-10" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
                          d="M3 6l3 1m0 0l-3 9a5.002 5.002 0 006.001 0M6 7l3 9M6 7l6-2m6 2l3-1m-3 1l-3 9a5.002 5.002 0 006.001 0M18 7l3 9m-3-9l-6-2m0-2v2m0 16V5m0 16H9m3 0h3"/>
                </svg>
            </div>
            <h3 class="text-lg font-semibold text-gray-900 mb-2">판례</h3>
            <p class="text-gray-600 text-sm">대법원, 각급법원 판결문 검색</p>
        </a>
        
        <!-- 헌재결정례 카드 -->
        <a href="/constitutional" class="bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition">
            <div class="text-green-600 mb-3">
                <svg class="w-10 h-10" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
                          d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"/>
                </svg>
            </div>
            <h3 class="text-lg font-semibold text-gray-900 mb-2">헌재결정례</h3>
            <p class="text-gray-600 text-sm">헌법재판소 결정문 검색</p>
        </a>
        
        <!-- 법령해석례 카드 -->
        <a href="/interpretations" class="bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition">
            <div class="text-purple-600 mb-3">
                <svg class="w-10 h-10" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
                          d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                </svg>
            </div>
            <h3 class="text-lg font-semibold text-gray-900 mb-2">법령해석례</h3>
            <p class="text-gray-600 text-sm">법제처 법령해석 사례 검색</p>
        </a>
    </div>
</div>
{% endblock %}
```

### 3.2 컨텍스트 변수
없음 (정적 페이지)

---

## 4. 판례 페이지

### 4.1 판례 목록 (cases/list.html)
```html
{% extends "base.html" %}

{% block title %}판례 검색{% if q %} - {{ q }}{% endif %}{% endblock %}

{% block content %}
<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-2xl font-bold text-gray-900 mb-6">판례 검색</h1>
    
    <!-- 검색 및 필터 -->
    <form method="GET" action="/cases" class="bg-white rounded-lg shadow p-6 mb-6">
        <!-- 검색어 -->
        <div class="flex gap-2 mb-4">
            <input type="text" name="q" value="{{ q or '' }}" 
                   placeholder="사건명, 판시사항, 판결요지 검색"
                   class="flex-1 px-4 py-2 border border-gray-300 rounded-lg 
                          focus:ring-2 focus:ring-blue-500">
            <button type="submit" 
                    class="px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700">
                검색
            </button>
        </div>
        
        <!-- 필터 옵션 -->
        <div x-data="{ showFilters: false }">
            <button type="button" @click="showFilters = !showFilters"
                    class="text-sm text-blue-600 hover:text-blue-800 mb-4">
                <span x-text="showFilters ? '필터 접기 ▲' : '필터 펼치기 ▼'"></span>
            </button>
            
            <div x-show="showFilters" x-cloak class="grid md:grid-cols-4 gap-4">
                <!-- 법원 종류 -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">법원</label>
                    <select name="court" class="w-full px-3 py-2 border border-gray-300 rounded-lg"
                            onchange="this.form.submit()">
                        <option value="">전체</option>
                        <option value="대법원" {% if court == '대법원' %}selected{% endif %}>대법원</option>
                        <option value="고등법원" {% if court == '고등법원' %}selected{% endif %}>고등법원</option>
                        <option value="지방법원" {% if court == '지방법원' %}selected{% endif %}>지방법원</option>
                    </select>
                </div>
                
                <!-- 사건 종류 -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">사건종류</label>
                    <select name="case_type" class="w-full px-3 py-2 border border-gray-300 rounded-lg"
                            onchange="this.form.submit()">
                        <option value="">전체</option>
                        <option value="민사" {% if case_type == '민사' %}selected{% endif %}>민사</option>
                        <option value="형사" {% if case_type == '형사' %}selected{% endif %}>형사</option>
                        <option value="행정" {% if case_type == '행정' %}selected{% endif %}>행정</option>
                        <option value="가사" {% if case_type == '가사' %}selected{% endif %}>가사</option>
                    </select>
                </div>
                
                <!-- 판결일 시작 -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">판결일 (시작)</label>
                    <input type="date" name="date_from" value="{{ date_from or '' }}"
                           class="w-full px-3 py-2 border border-gray-300 rounded-lg"
                           onchange="this.form.submit()">
                </div>
                
                <!-- 판결일 종료 -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">판결일 (종료)</label>
                    <input type="date" name="date_to" value="{{ date_to or '' }}"
                           class="w-full px-3 py-2 border border-gray-300 rounded-lg"
                           onchange="this.form.submit()">
                </div>
            </div>
        </div>
    </form>
    
    <!-- 검색 결과 정보 -->
    {% if cases %}
    <div class="flex justify-between items-center mb-4">
        <p class="text-gray-600">
            총 <span class="font-semibold">{{ total_count | number_format }}</span>건
            {% if q %}(검색어: "{{ q }}"){% endif %}
        </p>
        <p class="text-sm text-gray-500">
            {{ page }} / {{ total_pages }} 페이지
        </p>
    </div>
    {% endif %}
    
    <!-- 판례 목록 -->
    <div class="space-y-4">
        {% for case in cases %}
        <a href="/cases/{{ case.id }}" 
           class="block bg-white rounded-lg shadow hover:shadow-md transition p-6">
            <div class="flex justify-between items-start mb-2">
                <h2 class="text-lg font-semibold text-gray-900 hover:text-blue-600">
                    {{ case.case_name }}
                </h2>
                <span class="text-sm text-gray-500 whitespace-nowrap ml-4">
                    {{ case.judgment_date.strftime('%Y-%m-%d') }}
                </span>
            </div>
            
            <div class="flex flex-wrap gap-2 mb-3">
                <span class="px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded">
                    {{ case.court_name }}
                </span>
                <span class="px-2 py-1 bg-gray-100 text-gray-800 text-xs rounded">
                    {{ case.case_number }}
                </span>
                {% if case.case_type %}
                <span class="px-2 py-1 bg-green-100 text-green-800 text-xs rounded">
                    {{ case.case_type }}
                </span>
                {% endif %}
            </div>
            
            {% if case.judgment_summary %}
            <p class="text-gray-600 text-sm line-clamp-2">
                {{ case.judgment_summary[:200] }}{% if case.judgment_summary|length > 200 %}...{% endif %}
            </p>
            {% endif %}
        </a>
        {% else %}
        <div class="bg-white rounded-lg shadow p-12 text-center">
            <p class="text-gray-500">
                {% if q %}
                "{{ q }}"에 대한 검색 결과가 없습니다.
                {% else %}
                검색어를 입력하세요.
                {% endif %}
            </p>
        </div>
        {% endfor %}
    </div>
    
    <!-- 페이지네이션 -->
    {% if total_pages > 1 %}
    <nav class="flex justify-center mt-8">
        <ul class="flex items-center space-x-1">
            <!-- 이전 페이지 -->
            {% if page > 1 %}
            <li>
                <a href="?{{ query_string(page=page-1) }}" 
                   class="px-3 py-2 rounded-lg border border-gray-300 hover:bg-gray-50">
                    이전
                </a>
            </li>
            {% endif %}
            
            <!-- 페이지 번호 -->
            {% for p in range(1, total_pages + 1) %}
                {% if p == page %}
                <li>
                    <span class="px-3 py-2 rounded-lg bg-blue-600 text-white">{{ p }}</span>
                </li>
                {% elif p == 1 or p == total_pages or (p >= page - 2 and p <= page + 2) %}
                <li>
                    <a href="?{{ query_string(page=p) }}" 
                       class="px-3 py-2 rounded-lg border border-gray-300 hover:bg-gray-50">
                        {{ p }}
                    </a>
                </li>
                {% elif p == page - 3 or p == page + 3 %}
                <li><span class="px-2">...</span></li>
                {% endif %}
            {% endfor %}
            
            <!-- 다음 페이지 -->
            {% if page < total_pages %}
            <li>
                <a href="?{{ query_string(page=page+1) }}" 
                   class="px-3 py-2 rounded-lg border border-gray-300 hover:bg-gray-50">
                    다음
                </a>
            </li>
            {% endif %}
        </ul>
    </nav>
    {% endif %}
</div>
{% endblock %}
```

### 4.2 판례 목록 컨텍스트 변수
| 변수 | 타입 | 설명 |
|------|------|------|
| cases | List[Case] | 판례 목록 |
| q | str | 검색어 |
| court | str | 선택된 법원 |
| case_type | str | 선택된 사건종류 |
| date_from | str | 시작일 |
| date_to | str | 종료일 |
| page | int | 현재 페이지 |
| total_pages | int | 전체 페이지 수 |
| total_count | int | 전체 결과 수 |
| query_string | Callable | 쿼리스트링 생성 함수 |

### 4.3 판례 상세 (cases/detail.html)
```html
{% extends "base.html" %}

{% block title %}{{ case.case_name }} - 판례 상세{% endblock %}

{% block content %}
<div class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <!-- 뒤로가기 -->
    <a href="/cases{% if request.headers.get('Referer') and '/cases?' in request.headers.get('Referer', '') %}?{{ request.headers.get('Referer', '').split('?')[1] }}{% endif %}" 
       class="inline-flex items-center text-gray-600 hover:text-blue-600 mb-6">
        <svg class="w-5 h-5 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
        </svg>
        목록으로
    </a>
    
    <!-- 메타 정보 -->
    <div class="bg-white rounded-lg shadow p-6 mb-6">
        <h1 class="text-2xl font-bold text-gray-900 mb-4">{{ case.case_name }}</h1>
        
        <dl class="grid md:grid-cols-2 gap-4">
            <div>
                <dt class="text-sm text-gray-500">사건번호</dt>
                <dd class="font-medium">{{ case.case_number }}</dd>
            </div>
            <div>
                <dt class="text-sm text-gray-500">판결일자</dt>
                <dd class="font-medium">{{ case.judgment_date.strftime('%Y년 %m월 %d일') }}</dd>
            </div>
            <div>
                <dt class="text-sm text-gray-500">법원</dt>
                <dd class="font-medium">{{ case.court_name }}</dd>
            </div>
            <div>
                <dt class="text-sm text-gray-500">사건종류</dt>
                <dd class="font-medium">{{ case.case_type or '-' }}</dd>
            </div>
            {% if case.judgment_type %}
            <div>
                <dt class="text-sm text-gray-500">판결유형</dt>
                <dd class="font-medium">{{ case.judgment_type }}</dd>
            </div>
            {% endif %}
        </dl>
        
        <!-- 유사 문서 검색 버튼 -->
        <div class="mt-6 pt-6 border-t">
            <a href="/similarity?doc_type=case&doc_id={{ case.id }}" 
               class="inline-flex items-center px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700">
                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
                          d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/>
                </svg>
                유사 판례 찾기
            </a>
        </div>
    </div>
    
    <!-- 본문 탭 -->
    <div class="bg-white rounded-lg shadow" x-data="{ activeTab: 'summary' }">
        <!-- 탭 헤더 -->
        <div class="border-b">
            <nav class="flex -mb-px">
                <button @click="activeTab = 'summary'" 
                        :class="activeTab === 'summary' ? 'border-blue-500 text-blue-600' : 'border-transparent text-gray-500 hover:text-gray-700'"
                        class="px-6 py-4 border-b-2 font-medium text-sm">
                    판결요지
                </button>
                <button @click="activeTab = 'content'" 
                        :class="activeTab === 'content' ? 'border-blue-500 text-blue-600' : 'border-transparent text-gray-500 hover:text-gray-700'"
                        class="px-6 py-4 border-b-2 font-medium text-sm">
                    판결문 전문
                </button>
                {% if case.reference_provision %}
                <button @click="activeTab = 'reference'" 
                        :class="activeTab === 'reference' ? 'border-blue-500 text-blue-600' : 'border-transparent text-gray-500 hover:text-gray-700'"
                        class="px-6 py-4 border-b-2 font-medium text-sm">
                    참조조문
                </button>
                {% endif %}
                {% if case.reference_case %}
                <button @click="activeTab = 'refcase'" 
                        :class="activeTab === 'refcase' ? 'border-blue-500 text-blue-600' : 'border-transparent text-gray-500 hover:text-gray-700'"
                        class="px-6 py-4 border-b-2 font-medium text-sm">
                    참조판례
                </button>
                {% endif %}
            </nav>
        </div>
        
        <!-- 탭 내용 -->
        <div class="p-6">
            <!-- 판결요지 -->
            <div x-show="activeTab === 'summary'" x-cloak>
                {% if case.judgment_summary %}
                <div class="prose max-w-none">
                    {{ case.judgment_summary | nl2br | safe }}
                </div>
                {% else %}
                <p class="text-gray-500">판결요지가 없습니다.</p>
                {% endif %}
            </div>
            
            <!-- 판결문 전문 -->
            <div x-show="activeTab === 'content'" x-cloak>
                {% if case.full_text %}
                <div class="prose max-w-none whitespace-pre-wrap">
                    {{ case.full_text }}
                </div>
                {% else %}
                <p class="text-gray-500">판결문 전문이 없습니다.</p>
                {% endif %}
            </div>
            
            <!-- 참조조문 -->
            {% if case.reference_provision %}
            <div x-show="activeTab === 'reference'" x-cloak>
                <div class="prose max-w-none">
                    {{ case.reference_provision | nl2br | safe }}
                </div>
            </div>
            {% endif %}
            
            <!-- 참조판례 -->
            {% if case.reference_case %}
            <div x-show="activeTab === 'refcase'" x-cloak>
                <div class="prose max-w-none">
                    {{ case.reference_case | nl2br | safe }}
                </div>
            </div>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}
```

### 4.4 판례 상세 컨텍스트 변수
| 변수 | 타입 | 설명 |
|------|------|------|
| case | Case | 판례 객체 |
| request | Request | FastAPI Request 객체 |

---

## 5. 헌재결정례 페이지

### 5.1 헌재결정례 목록 (constitutional/list.html)
```html
{% extends "base.html" %}

{% block title %}헌재결정례 검색{% if q %} - {{ q }}{% endif %}{% endblock %}

{% block content %}
<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-2xl font-bold text-gray-900 mb-6">헌재결정례 검색</h1>
    
    <!-- 검색 및 필터 -->
    <form method="GET" action="/constitutional" class="bg-white rounded-lg shadow p-6 mb-6">
        <div class="flex gap-2 mb-4">
            <input type="text" name="q" value="{{ q or '' }}" 
                   placeholder="사건명, 판시사항, 결정요지 검색"
                   class="flex-1 px-4 py-2 border border-gray-300 rounded-lg 
                          focus:ring-2 focus:ring-green-500">
            <button type="submit" 
                    class="px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700">
                검색
            </button>
        </div>
        
        <div x-data="{ showFilters: false }">
            <button type="button" @click="showFilters = !showFilters"
                    class="text-sm text-green-600 hover:text-green-800 mb-4">
                <span x-text="showFilters ? '필터 접기 ▲' : '필터 펼치기 ▼'"></span>
            </button>
            
            <div x-show="showFilters" x-cloak class="grid md:grid-cols-3 gap-4">
                <!-- 사건종류 -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">사건종류</label>
                    <select name="case_type" class="w-full px-3 py-2 border border-gray-300 rounded-lg"
                            onchange="this.form.submit()">
                        <option value="">전체</option>
                        <option value="위헌법률심판" {% if case_type == '위헌법률심판' %}selected{% endif %}>위헌법률심판</option>
                        <option value="헌법소원" {% if case_type == '헌법소원' %}selected{% endif %}>헌법소원</option>
                        <option value="권한쟁의" {% if case_type == '권한쟁의' %}selected{% endif %}>권한쟁의</option>
                        <option value="탄핵심판" {% if case_type == '탄핵심판' %}selected{% endif %}>탄핵심판</option>
                    </select>
                </div>
                
                <!-- 결정일 시작 -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">결정일 (시작)</label>
                    <input type="date" name="date_from" value="{{ date_from or '' }}"
                           class="w-full px-3 py-2 border border-gray-300 rounded-lg"
                           onchange="this.form.submit()">
                </div>
                
                <!-- 결정일 종료 -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">결정일 (종료)</label>
                    <input type="date" name="date_to" value="{{ date_to or '' }}"
                           class="w-full px-3 py-2 border border-gray-300 rounded-lg"
                           onchange="this.form.submit()">
                </div>
            </div>
        </div>
    </form>
    
    <!-- 검색 결과 정보 -->
    {% if decisions %}
    <div class="flex justify-between items-center mb-4">
        <p class="text-gray-600">
            총 <span class="font-semibold">{{ total_count | number_format }}</span>건
        </p>
        <p class="text-sm text-gray-500">{{ page }} / {{ total_pages }} 페이지</p>
    </div>
    {% endif %}
    
    <!-- 결정례 목록 -->
    <div class="space-y-4">
        {% for decision in decisions %}
        <a href="/constitutional/{{ decision.id }}" 
           class="block bg-white rounded-lg shadow hover:shadow-md transition p-6">
            <div class="flex justify-between items-start mb-2">
                <h2 class="text-lg font-semibold text-gray-900 hover:text-green-600">
                    {{ decision.case_name }}
                </h2>
                <span class="text-sm text-gray-500 whitespace-nowrap ml-4">
                    {{ decision.decision_date.strftime('%Y-%m-%d') }}
                </span>
            </div>
            
            <div class="flex flex-wrap gap-2 mb-3">
                <span class="px-2 py-1 bg-green-100 text-green-800 text-xs rounded">
                    헌법재판소
                </span>
                <span class="px-2 py-1 bg-gray-100 text-gray-800 text-xs rounded">
                    {{ decision.case_number }}
                </span>
                {% if decision.case_type %}
                <span class="px-2 py-1 bg-yellow-100 text-yellow-800 text-xs rounded">
                    {{ decision.case_type }}
                </span>
                {% endif %}
                {% if decision.decision_type %}
                <span class="px-2 py-1 bg-red-100 text-red-800 text-xs rounded">
                    {{ decision.decision_type }}
                </span>
                {% endif %}
            </div>
            
            {% if decision.decision_summary %}
            <p class="text-gray-600 text-sm line-clamp-2">
                {{ decision.decision_summary[:200] }}{% if decision.decision_summary|length > 200 %}...{% endif %}
            </p>
            {% endif %}
        </a>
        {% else %}
        <div class="bg-white rounded-lg shadow p-12 text-center">
            <p class="text-gray-500">
                {% if q %}"{{ q }}"에 대한 검색 결과가 없습니다.{% else %}검색어를 입력하세요.{% endif %}
            </p>
        </div>
        {% endfor %}
    </div>
    
    <!-- 페이지네이션 -->
    {% if total_pages > 1 %}
    <nav class="flex justify-center mt-8">
        <ul class="flex items-center space-x-1">
            {% if page > 1 %}
            <li>
                <a href="?{{ query_string(page=page-1) }}" 
                   class="px-3 py-2 rounded-lg border border-gray-300 hover:bg-gray-50">이전</a>
            </li>
            {% endif %}
            
            {% for p in range(1, total_pages + 1) %}
                {% if p == page %}
                <li><span class="px-3 py-2 rounded-lg bg-green-600 text-white">{{ p }}</span></li>
                {% elif p == 1 or p == total_pages or (p >= page - 2 and p <= page + 2) %}
                <li>
                    <a href="?{{ query_string(page=p) }}" 
                       class="px-3 py-2 rounded-lg border border-gray-300 hover:bg-gray-50">{{ p }}</a>
                </li>
                {% elif p == page - 3 or p == page + 3 %}
                <li><span class="px-2">...</span></li>
                {% endif %}
            {% endfor %}
            
            {% if page < total_pages %}
            <li>
                <a href="?{{ query_string(page=page+1) }}" 
                   class="px-3 py-2 rounded-lg border border-gray-300 hover:bg-gray-50">다음</a>
            </li>
            {% endif %}
        </ul>
    </nav>
    {% endif %}
</div>
{% endblock %}
```

### 5.2 헌재결정례 목록 컨텍스트 변수
| 변수 | 타입 | 설명 |
|------|------|------|
| decisions | List[ConstitutionalDecision] | 헌재결정례 목록 |
| q | str | 검색어 |
| case_type | str | 사건종류 필터 |
| date_from | str | 시작일 |
| date_to | str | 종료일 |
| page | int | 현재 페이지 |
| total_pages | int | 전체 페이지 수 |
| total_count | int | 전체 결과 수 |

### 5.3 헌재결정례 상세 (constitutional/detail.html)
```html
{% extends "base.html" %}

{% block title %}{{ decision.case_name }} - 헌재결정례 상세{% endblock %}

{% block content %}
<div class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <a href="/constitutional" class="inline-flex items-center text-gray-600 hover:text-green-600 mb-6">
        <svg class="w-5 h-5 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
        </svg>
        목록으로
    </a>
    
    <!-- 메타 정보 -->
    <div class="bg-white rounded-lg shadow p-6 mb-6">
        <h1 class="text-2xl font-bold text-gray-900 mb-4">{{ decision.case_name }}</h1>
        
        <dl class="grid md:grid-cols-2 gap-4">
            <div>
                <dt class="text-sm text-gray-500">사건번호</dt>
                <dd class="font-medium">{{ decision.case_number }}</dd>
            </div>
            <div>
                <dt class="text-sm text-gray-500">결정일자</dt>
                <dd class="font-medium">{{ decision.decision_date.strftime('%Y년 %m월 %d일') }}</dd>
            </div>
            <div>
                <dt class="text-sm text-gray-500">사건종류</dt>
                <dd class="font-medium">{{ decision.case_type or '-' }}</dd>
            </div>
            <div>
                <dt class="text-sm text-gray-500">결정유형</dt>
                <dd class="font-medium">{{ decision.decision_type or '-' }}</dd>
            </div>
        </dl>
        
        <div class="mt-6 pt-6 border-t">
            <a href="/similarity?doc_type=constitutional&doc_id={{ decision.id }}" 
               class="inline-flex items-center px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700">
                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
                          d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/>
                </svg>
                유사 결정례 찾기
            </a>
        </div>
    </div>
    
    <!-- 본문 탭 -->
    <div class="bg-white rounded-lg shadow" x-data="{ activeTab: 'summary' }">
        <div class="border-b">
            <nav class="flex -mb-px">
                <button @click="activeTab = 'summary'" 
                        :class="activeTab === 'summary' ? 'border-green-500 text-green-600' : 'border-transparent text-gray-500'"
                        class="px-6 py-4 border-b-2 font-medium text-sm">결정요지</button>
                <button @click="activeTab = 'content'" 
                        :class="activeTab === 'content' ? 'border-green-500 text-green-600' : 'border-transparent text-gray-500'"
                        class="px-6 py-4 border-b-2 font-medium text-sm">결정문 전문</button>
                {% if decision.dissenting_opinion %}
                <button @click="activeTab = 'dissent'" 
                        :class="activeTab === 'dissent' ? 'border-green-500 text-green-600' : 'border-transparent text-gray-500'"
                        class="px-6 py-4 border-b-2 font-medium text-sm">반대의견</button>
                {% endif %}
            </nav>
        </div>
        
        <div class="p-6">
            <div x-show="activeTab === 'summary'" x-cloak>
                {% if decision.decision_summary %}
                <div class="prose max-w-none">{{ decision.decision_summary | nl2br | safe }}</div>
                {% else %}
                <p class="text-gray-500">결정요지가 없습니다.</p>
                {% endif %}
            </div>
            
            <div x-show="activeTab === 'content'" x-cloak>
                {% if decision.full_text %}
                <div class="prose max-w-none whitespace-pre-wrap">{{ decision.full_text }}</div>
                {% else %}
                <p class="text-gray-500">결정문 전문이 없습니다.</p>
                {% endif %}
            </div>
            
            {% if decision.dissenting_opinion %}
            <div x-show="activeTab === 'dissent'" x-cloak>
                <div class="prose max-w-none">{{ decision.dissenting_opinion | nl2br | safe }}</div>
            </div>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}
```

### 5.4 헌재결정례 상세 컨텍스트 변수
| 변수 | 타입 | 설명 |
|------|------|------|
| decision | ConstitutionalDecision | 헌재결정례 객체 |

---

## 6. 법령해석례 페이지

### 6.1 법령해석례 목록 (interpretations/list.html)
```html
{% extends "base.html" %}

{% block title %}법령해석례 검색{% if q %} - {{ q }}{% endif %}{% endblock %}

{% block content %}
<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-2xl font-bold text-gray-900 mb-6">법령해석례 검색</h1>
    
    <!-- 검색 및 필터 -->
    <form method="GET" action="/interpretations" class="bg-white rounded-lg shadow p-6 mb-6">
        <div class="flex gap-2 mb-4">
            <input type="text" name="q" value="{{ q or '' }}" 
                   placeholder="제목, 질의요지, 회답 검색"
                   class="flex-1 px-4 py-2 border border-gray-300 rounded-lg 
                          focus:ring-2 focus:ring-purple-500">
            <button type="submit" 
                    class="px-6 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700">
                검색
            </button>
        </div>
        
        <div x-data="{ showFilters: false }">
            <button type="button" @click="showFilters = !showFilters"
                    class="text-sm text-purple-600 hover:text-purple-800 mb-4">
                <span x-text="showFilters ? '필터 접기 ▲' : '필터 펼치기 ▼'"></span>
            </button>
            
            <div x-show="showFilters" x-cloak class="grid md:grid-cols-3 gap-4">
                <!-- 해석기관 -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">해석기관</label>
                    <select name="agency" class="w-full px-3 py-2 border border-gray-300 rounded-lg"
                            onchange="this.form.submit()">
                        <option value="">전체</option>
                        <option value="법제처" {% if agency == '법제처' %}selected{% endif %}>법제처</option>
                        <option value="국민권익위원회" {% if agency == '국민권익위원회' %}selected{% endif %}>국민권익위원회</option>
                    </select>
                </div>
                
                <!-- 회신일 시작 -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">회신일 (시작)</label>
                    <input type="date" name="date_from" value="{{ date_from or '' }}"
                           class="w-full px-3 py-2 border border-gray-300 rounded-lg"
                           onchange="this.form.submit()">
                </div>
                
                <!-- 회신일 종료 -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">회신일 (종료)</label>
                    <input type="date" name="date_to" value="{{ date_to or '' }}"
                           class="w-full px-3 py-2 border border-gray-300 rounded-lg"
                           onchange="this.form.submit()">
                </div>
            </div>
        </div>
    </form>
    
    <!-- 검색 결과 정보 -->
    {% if interpretations %}
    <div class="flex justify-between items-center mb-4">
        <p class="text-gray-600">
            총 <span class="font-semibold">{{ total_count | number_format }}</span>건
        </p>
        <p class="text-sm text-gray-500">{{ page }} / {{ total_pages }} 페이지</p>
    </div>
    {% endif %}
    
    <!-- 해석례 목록 -->
    <div class="space-y-4">
        {% for interp in interpretations %}
        <a href="/interpretations/{{ interp.id }}" 
           class="block bg-white rounded-lg shadow hover:shadow-md transition p-6">
            <div class="flex justify-between items-start mb-2">
                <h2 class="text-lg font-semibold text-gray-900 hover:text-purple-600">
                    {{ interp.title }}
                </h2>
                <span class="text-sm text-gray-500 whitespace-nowrap ml-4">
                    {{ interp.reply_date.strftime('%Y-%m-%d') }}
                </span>
            </div>
            
            <div class="flex flex-wrap gap-2 mb-3">
                <span class="px-2 py-1 bg-purple-100 text-purple-800 text-xs rounded">
                    {{ interp.agency or '법제처' }}
                </span>
                <span class="px-2 py-1 bg-gray-100 text-gray-800 text-xs rounded">
                    {{ interp.doc_number }}
                </span>
                {% if interp.related_law %}
                <span class="px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded">
                    {{ interp.related_law }}
                </span>
                {% endif %}
            </div>
            
            {% if interp.question_summary %}
            <p class="text-gray-600 text-sm line-clamp-2">
                <strong class="text-gray-700">질의:</strong> 
                {{ interp.question_summary[:150] }}{% if interp.question_summary|length > 150 %}...{% endif %}
            </p>
            {% endif %}
        </a>
        {% else %}
        <div class="bg-white rounded-lg shadow p-12 text-center">
            <p class="text-gray-500">
                {% if q %}"{{ q }}"에 대한 검색 결과가 없습니다.{% else %}검색어를 입력하세요.{% endif %}
            </p>
        </div>
        {% endfor %}
    </div>
    
    <!-- 페이지네이션 -->
    {% if total_pages > 1 %}
    <nav class="flex justify-center mt-8">
        <ul class="flex items-center space-x-1">
            {% if page > 1 %}
            <li>
                <a href="?{{ query_string(page=page-1) }}" 
                   class="px-3 py-2 rounded-lg border border-gray-300 hover:bg-gray-50">이전</a>
            </li>
            {% endif %}
            
            {% for p in range(1, total_pages + 1) %}
                {% if p == page %}
                <li><span class="px-3 py-2 rounded-lg bg-purple-600 text-white">{{ p }}</span></li>
                {% elif p == 1 or p == total_pages or (p >= page - 2 and p <= page + 2) %}
                <li>
                    <a href="?{{ query_string(page=p) }}" 
                       class="px-3 py-2 rounded-lg border border-gray-300 hover:bg-gray-50">{{ p }}</a>
                </li>
                {% elif p == page - 3 or p == page + 3 %}
                <li><span class="px-2">...</span></li>
                {% endif %}
            {% endfor %}
            
            {% if page < total_pages %}
            <li>
                <a href="?{{ query_string(page=page+1) }}" 
                   class="px-3 py-2 rounded-lg border border-gray-300 hover:bg-gray-50">다음</a>
            </li>
            {% endif %}
        </ul>
    </nav>
    {% endif %}
</div>
{% endblock %}
```

### 6.2 법령해석례 목록 컨텍스트 변수
| 변수 | 타입 | 설명 |
|------|------|------|
| interpretations | List[LegalInterpretation] | 법령해석례 목록 |
| q | str | 검색어 |
| agency | str | 해석기관 필터 |
| date_from | str | 시작일 |
| date_to | str | 종료일 |
| page | int | 현재 페이지 |
| total_pages | int | 전체 페이지 수 |
| total_count | int | 전체 결과 수 |

### 6.3 법령해석례 상세 (interpretations/detail.html)
```html
{% extends "base.html" %}

{% block title %}{{ interp.title }} - 법령해석례 상세{% endblock %}

{% block content %}
<div class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <a href="/interpretations" class="inline-flex items-center text-gray-600 hover:text-purple-600 mb-6">
        <svg class="w-5 h-5 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
        </svg>
        목록으로
    </a>
    
    <!-- 메타 정보 -->
    <div class="bg-white rounded-lg shadow p-6 mb-6">
        <h1 class="text-2xl font-bold text-gray-900 mb-4">{{ interp.title }}</h1>
        
        <dl class="grid md:grid-cols-2 gap-4">
            <div>
                <dt class="text-sm text-gray-500">문서번호</dt>
                <dd class="font-medium">{{ interp.doc_number }}</dd>
            </div>
            <div>
                <dt class="text-sm text-gray-500">회신일자</dt>
                <dd class="font-medium">{{ interp.reply_date.strftime('%Y년 %m월 %d일') }}</dd>
            </div>
            <div>
                <dt class="text-sm text-gray-500">해석기관</dt>
                <dd class="font-medium">{{ interp.agency or '법제처' }}</dd>
            </div>
            {% if interp.related_law %}
            <div>
                <dt class="text-sm text-gray-500">관련법령</dt>
                <dd class="font-medium">{{ interp.related_law }}</dd>
            </div>
            {% endif %}
        </dl>
        
        <div class="mt-6 pt-6 border-t">
            <a href="/similarity?doc_type=interpretation&doc_id={{ interp.id }}" 
               class="inline-flex items-center px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700">
                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
                          d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/>
                </svg>
                유사 해석례 찾기
            </a>
        </div>
    </div>
    
    <!-- 본문 -->
    <div class="bg-white rounded-lg shadow" x-data="{ activeTab: 'question' }">
        <div class="border-b">
            <nav class="flex -mb-px">
                <button @click="activeTab = 'question'" 
                        :class="activeTab === 'question' ? 'border-purple-500 text-purple-600' : 'border-transparent text-gray-500'"
                        class="px-6 py-4 border-b-2 font-medium text-sm">질의요지</button>
                <button @click="activeTab = 'reply'" 
                        :class="activeTab === 'reply' ? 'border-purple-500 text-purple-600' : 'border-transparent text-gray-500'"
                        class="px-6 py-4 border-b-2 font-medium text-sm">회답</button>
                <button @click="activeTab = 'reason'" 
                        :class="activeTab === 'reason' ? 'border-purple-500 text-purple-600' : 'border-transparent text-gray-500'"
                        class="px-6 py-4 border-b-2 font-medium text-sm">이유</button>
            </nav>
        </div>
        
        <div class="p-6">
            <div x-show="activeTab === 'question'" x-cloak>
                {% if interp.question %}
                <div class="prose max-w-none">{{ interp.question | nl2br | safe }}</div>
                {% else %}
                <p class="text-gray-500">질의요지가 없습니다.</p>
                {% endif %}
            </div>
            
            <div x-show="activeTab === 'reply'" x-cloak>
                {% if interp.reply %}
                <div class="prose max-w-none">{{ interp.reply | nl2br | safe }}</div>
                {% else %}
                <p class="text-gray-500">회답이 없습니다.</p>
                {% endif %}
            </div>
            
            <div x-show="activeTab === 'reason'" x-cloak>
                {% if interp.reason %}
                <div class="prose max-w-none whitespace-pre-wrap">{{ interp.reason }}</div>
                {% else %}
                <p class="text-gray-500">이유가 없습니다.</p>
                {% endif %}
            </div>
        </div>
    </div>
</div>
{% endblock %}
```

### 6.4 법령해석례 상세 컨텍스트 변수
| 변수 | 타입 | 설명 |
|------|------|------|
| interp | LegalInterpretation | 법령해석례 객체 |

---

## 7. 유사 문서 검색 페이지 (similarity/results.html)

### 7.1 템플릿 코드
```html
{% extends "base.html" %}

{% block title %}유사 문서 검색 결과{% endblock %}

{% block content %}
<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-2xl font-bold text-gray-900 mb-6">유사 문서 검색</h1>
    
    <!-- 기준 문서 정보 -->
    {% if source_doc %}
    <div class="bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg p-6 mb-6 border border-blue-100">
        <p class="text-sm text-blue-600 mb-2">기준 문서</p>
        <h2 class="text-lg font-semibold text-gray-900">{{ source_doc.title }}</h2>
        <div class="flex gap-2 mt-2">
            <span class="px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded">
                {% if doc_type == 'case' %}판례
                {% elif doc_type == 'constitutional' %}헌재결정례
                {% else %}법령해석례
                {% endif %}
            </span>
            <span class="text-sm text-gray-500">{{ source_doc.date }}</span>
        </div>
    </div>
    {% endif %}
    
    <!-- 텍스트 직접 입력 검색 -->
    <form method="POST" action="/similarity" class="bg-white rounded-lg shadow p-6 mb-6">
        <label class="block text-sm font-medium text-gray-700 mb-2">
            텍스트로 유사 문서 검색
        </label>
        <textarea name="text" rows="4" 
                  class="w-full px-4 py-2 border border-gray-300 rounded-lg 
                         focus:ring-2 focus:ring-blue-500"
                  placeholder="검색하고 싶은 법률 내용을 입력하세요...">{{ search_text or '' }}</textarea>
        
        <div class="flex gap-4 mt-4">
            <div>
                <label class="block text-sm text-gray-600 mb-1">검색 대상</label>
                <select name="target_type" class="px-3 py-2 border border-gray-300 rounded-lg">
                    <option value="all" {% if target_type == 'all' %}selected{% endif %}>전체</option>
                    <option value="case" {% if target_type == 'case' %}selected{% endif %}>판례</option>
                    <option value="constitutional" {% if target_type == 'constitutional' %}selected{% endif %}>헌재결정례</option>
                    <option value="interpretation" {% if target_type == 'interpretation' %}selected{% endif %}>법령해석례</option>
                </select>
            </div>
            <div>
                <label class="block text-sm text-gray-600 mb-1">결과 수</label>
                <select name="limit" class="px-3 py-2 border border-gray-300 rounded-lg">
                    <option value="10" {% if limit == 10 %}selected{% endif %}>10개</option>
                    <option value="20" {% if limit == 20 %}selected{% endif %}>20개</option>
                    <option value="50" {% if limit == 50 %}selected{% endif %}>50개</option>
                </select>
            </div>
            <div class="flex items-end">
                <button type="submit" 
                        class="px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700">
                    유사 문서 검색
                </button>
            </div>
        </div>
    </form>
    
    <!-- 검색 결과 -->
    {% if similar_docs %}
    <div class="mb-4">
        <p class="text-gray-600">
            유사도 높은 문서 <span class="font-semibold">{{ similar_docs | length }}</span>건
        </p>
    </div>
    
    <div class="space-y-4">
        {% for doc in similar_docs %}
        <div class="bg-white rounded-lg shadow p-6">
            <div class="flex justify-between items-start">
                <div class="flex-1">
                    <div class="flex items-center gap-2 mb-2">
                        <!-- 문서 유형 뱃지 -->
                        {% if doc.doc_type == 'case' %}
                        <span class="px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded">판례</span>
                        {% elif doc.doc_type == 'constitutional' %}
                        <span class="px-2 py-1 bg-green-100 text-green-800 text-xs rounded">헌재결정례</span>
                        {% else %}
                        <span class="px-2 py-1 bg-purple-100 text-purple-800 text-xs rounded">법령해석례</span>
                        {% endif %}
                        
                        <!-- 유사도 점수 -->
                        <span class="px-2 py-1 bg-yellow-100 text-yellow-800 text-xs rounded font-medium">
                            {{ (doc.similarity * 100) | round(1) }}% 유사
                        </span>
                    </div>
                    
                    <a href="{{ doc.url }}" class="text-lg font-semibold text-gray-900 hover:text-blue-600">
                        {{ doc.title }}
                    </a>
                    
                    <p class="text-sm text-gray-500 mt-1">
                        {{ doc.meta_info }}
                    </p>
                    
                    {% if doc.snippet %}
                    <p class="text-gray-600 text-sm mt-2 line-clamp-2">
                        {{ doc.snippet }}
                    </p>
                    {% endif %}
                </div>
                
                <!-- 유사도 바 -->
                <div class="ml-4 w-24">
                    <div class="text-center mb-1">
                        <span class="text-2xl font-bold text-blue-600">
                            {{ (doc.similarity * 100) | round(0) | int }}
                        </span>
                        <span class="text-sm text-gray-500">%</span>
                    </div>
                    <div class="h-2 bg-gray-200 rounded-full overflow-hidden">
                        <div class="h-full bg-blue-600 rounded-full" 
                             style="width: {{ doc.similarity * 100 }}%"></div>
                    </div>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
    {% elif search_text or source_doc %}
    <div class="bg-white rounded-lg shadow p-12 text-center">
        <p class="text-gray-500">유사한 문서를 찾을 수 없습니다.</p>
    </div>
    {% endif %}
</div>
{% endblock %}
```

### 7.2 유사 검색 컨텍스트 변수
| 변수 | 타입 | 설명 |
|------|------|------|
| source_doc | dict | 기준 문서 정보 (title, date) |
| doc_type | str | 기준 문서 유형 (case/constitutional/interpretation) |
| search_text | str | 직접 입력한 검색 텍스트 |
| target_type | str | 검색 대상 유형 필터 |
| limit | int | 결과 개수 제한 |
| similar_docs | List[dict] | 유사 문서 목록 |

### 7.3 similar_docs 항목 구조
| 필드 | 타입 | 설명 |
|------|------|------|
| doc_type | str | 문서 유형 |
| title | str | 문서 제목 |
| url | str | 상세 페이지 URL |
| meta_info | str | 메타 정보 (법원, 날짜 등) |
| snippet | str | 본문 일부 |
| similarity | float | 유사도 점수 (0.0 ~ 1.0) |

---

## 8. 재사용 컴포넌트 (Jinja2 매크로)

### 8.1 매크로 파일 (templates/macros.html)
```html
{# 페이지네이션 매크로 #}
{% macro pagination(page, total_pages, query_string_func) %}
{% if total_pages > 1 %}
<nav class="flex justify-center mt-8">
    <ul class="flex items-center space-x-1">
        {% if page > 1 %}
        <li>
            <a href="?{{ query_string_func(page=page-1) }}" 
               class="px-3 py-2 rounded-lg border border-gray-300 hover:bg-gray-50">이전</a>
        </li>
        {% endif %}
        
        {% for p in range(1, total_pages + 1) %}
            {% if p == page %}
            <li><span class="px-3 py-2 rounded-lg bg-blue-600 text-white">{{ p }}</span></li>
            {% elif p == 1 or p == total_pages or (p >= page - 2 and p <= page + 2) %}
            <li>
                <a href="?{{ query_string_func(page=p) }}" 
                   class="px-3 py-2 rounded-lg border border-gray-300 hover:bg-gray-50">{{ p }}</a>
            </li>
            {% elif p == page - 3 or p == page + 3 %}
            <li><span class="px-2">...</span></li>
            {% endif %}
        {% endfor %}
        
        {% if page < total_pages %}
        <li>
            <a href="?{{ query_string_func(page=page+1) }}" 
               class="px-3 py-2 rounded-lg border border-gray-300 hover:bg-gray-50">다음</a>
        </li>
        {% endif %}
    </ul>
</nav>
{% endif %}
{% endmacro %}

{# 빈 결과 메시지 #}
{% macro empty_result(query=None, message="검색 결과가 없습니다.") %}
<div class="bg-white rounded-lg shadow p-12 text-center">
    <svg class="w-16 h-16 mx-auto text-gray-300 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
              d="M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
    </svg>
    <p class="text-gray-500">
        {% if query %}"{{ query }}"에 대한 {% endif %}{{ message }}
    </p>
</div>
{% endmacro %}

{# 문서 뱃지 #}
{% macro doc_badge(doc_type) %}
{% if doc_type == 'case' %}
<span class="px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded">판례</span>
{% elif doc_type == 'constitutional' %}
<span class="px-2 py-1 bg-green-100 text-green-800 text-xs rounded">헌재결정례</span>
{% else %}
<span class="px-2 py-1 bg-purple-100 text-purple-800 text-xs rounded">법령해석례</span>
{% endif %}
{% endmacro %}

{# 날짜 포맷 #}
{% macro format_date(date, format='%Y-%m-%d') %}
{{ date.strftime(format) if date else '-' }}
{% endmacro %}
```

### 8.2 매크로 사용법
```html
{% from "macros.html" import pagination, empty_result, doc_badge %}

{# 페이지네이션 사용 #}
{{ pagination(page, total_pages, query_string) }}

{# 빈 결과 표시 #}
{{ empty_result(query=q, message="검색 결과가 없습니다.") }}

{# 문서 뱃지 #}
{{ doc_badge('case') }}
```

---

## 9. FastAPI 라우트 예시

### 9.1 템플릿 렌더링 설정
```python
from fastapi import FastAPI, Request
from fastapi.templating import Jinja2Templates
from fastapi.staticfiles import StaticFiles
from urllib.parse import urlencode

app = FastAPI()
app.mount("/static", StaticFiles(directory="static"), name="static")
templates = Jinja2Templates(directory="templates")

# 커스텀 필터 등록
def nl2br(value: str) -> str:
    """줄바꿈을 <br>로 변환"""
    if value:
        return value.replace('\n', '<br>\n')
    return ''

def number_format(value: int) -> str:
    """숫자에 천단위 콤마 추가"""
    return f"{value:,}"

templates.env.filters['nl2br'] = nl2br
templates.env.filters['number_format'] = number_format
```

### 9.2 쿼리스트링 헬퍼 함수
```python
def make_query_string_func(request: Request):
    """현재 쿼리 파라미터 유지하면서 특정 값만 변경하는 함수 생성"""
    def query_string(**kwargs):
        params = dict(request.query_params)
        params.update(kwargs)
        # None 값 제거
        params = {k: v for k, v in params.items() if v is not None and v != ''}
        return urlencode(params)
    return query_string
```

### 9.3 판례 라우트
```python
from fastapi import Query
from typing import Optional

@app.get("/cases")
async def case_list(
    request: Request,
    q: Optional[str] = Query(None),
    court: Optional[str] = Query(None),
    case_type: Optional[str] = Query(None),
    date_from: Optional[str] = Query(None),
    date_to: Optional[str] = Query(None),
    page: int = Query(1, ge=1),
    size: int = Query(20, ge=1, le=100)
):
    # DB에서 판례 조회
    cases, total_count = await case_service.search(
        query=q,
        court=court,
        case_type=case_type,
        date_from=date_from,
        date_to=date_to,
        page=page,
        size=size
    )
    
    total_pages = (total_count + size - 1) // size
    
    return templates.TemplateResponse("cases/list.html", {
        "request": request,
        "cases": cases,
        "q": q,
        "court": court,
        "case_type": case_type,
        "date_from": date_from,
        "date_to": date_to,
        "page": page,
        "total_pages": total_pages,
        "total_count": total_count,
        "query_string": make_query_string_func(request)
    })

@app.get("/cases/{case_id}")
async def case_detail(request: Request, case_id: int):
    case = await case_service.get_by_id(case_id)
    if not case:
        raise HTTPException(status_code=404, detail="판례를 찾을 수 없습니다.")
    
    return templates.TemplateResponse("cases/detail.html", {
        "request": request,
        "case": case
    })
```

### 9.4 헌재결정례 라우트
```python
@app.get("/constitutional")
async def constitutional_list(
    request: Request,
    q: Optional[str] = Query(None),
    case_type: Optional[str] = Query(None),
    date_from: Optional[str] = Query(None),
    date_to: Optional[str] = Query(None),
    page: int = Query(1, ge=1),
    size: int = Query(20)
):
    decisions, total_count = await constitutional_service.search(
        query=q,
        case_type=case_type,
        date_from=date_from,
        date_to=date_to,
        page=page,
        size=size
    )
    
    total_pages = (total_count + size - 1) // size
    
    return templates.TemplateResponse("constitutional/list.html", {
        "request": request,
        "decisions": decisions,
        "q": q,
        "case_type": case_type,
        "date_from": date_from,
        "date_to": date_to,
        "page": page,
        "total_pages": total_pages,
        "total_count": total_count,
        "query_string": make_query_string_func(request)
    })

@app.get("/constitutional/{decision_id}")
async def constitutional_detail(request: Request, decision_id: int):
    decision = await constitutional_service.get_by_id(decision_id)
    if not decision:
        raise HTTPException(status_code=404)
    
    return templates.TemplateResponse("constitutional/detail.html", {
        "request": request,
        "decision": decision
    })
```

### 9.5 법령해석례 라우트
```python
@app.get("/interpretations")
async def interpretation_list(
    request: Request,
    q: Optional[str] = Query(None),
    agency: Optional[str] = Query(None),
    date_from: Optional[str] = Query(None),
    date_to: Optional[str] = Query(None),
    page: int = Query(1, ge=1),
    size: int = Query(20)
):
    interpretations, total_count = await interpretation_service.search(
        query=q,
        agency=agency,
        date_from=date_from,
        date_to=date_to,
        page=page,
        size=size
    )
    
    total_pages = (total_count + size - 1) // size
    
    return templates.TemplateResponse("interpretations/list.html", {
        "request": request,
        "interpretations": interpretations,
        "q": q,
        "agency": agency,
        "date_from": date_from,
        "date_to": date_to,
        "page": page,
        "total_pages": total_pages,
        "total_count": total_count,
        "query_string": make_query_string_func(request)
    })

@app.get("/interpretations/{interp_id}")
async def interpretation_detail(request: Request, interp_id: int):
    interp = await interpretation_service.get_by_id(interp_id)
    if not interp:
        raise HTTPException(status_code=404)
    
    return templates.TemplateResponse("interpretations/detail.html", {
        "request": request,
        "interp": interp
    })
```

### 9.6 유사 문서 검색 라우트
```python
@app.get("/similarity")
async def similarity_search_get(
    request: Request,
    doc_type: Optional[str] = Query(None),
    doc_id: Optional[int] = Query(None),
    target_type: str = Query("all"),
    limit: int = Query(20)
):
    source_doc = None
    similar_docs = []
    
    if doc_type and doc_id:
        # 기준 문서 조회
        if doc_type == "case":
            doc = await case_service.get_by_id(doc_id)
            source_doc = {"title": doc.case_name, "date": doc.judgment_date}
        elif doc_type == "constitutional":
            doc = await constitutional_service.get_by_id(doc_id)
            source_doc = {"title": doc.case_name, "date": doc.decision_date}
        else:
            doc = await interpretation_service.get_by_id(doc_id)
            source_doc = {"title": doc.title, "date": doc.reply_date}
        
        # 유사 문서 검색
        similar_docs = await similarity_service.find_similar(
            doc_type=doc_type,
            doc_id=doc_id,
            target_type=target_type,
            limit=limit
        )
    
    return templates.TemplateResponse("similarity/results.html", {
        "request": request,
        "source_doc": source_doc,
        "doc_type": doc_type,
        "similar_docs": similar_docs,
        "target_type": target_type,
        "limit": limit,
        "search_text": None
    })

@app.post("/similarity")
async def similarity_search_post(
    request: Request,
    text: str = Form(...),
    target_type: str = Form("all"),
    limit: int = Form(20)
):
    # 텍스트 기반 유사 검색
    similar_docs = await similarity_service.find_similar_by_text(
        text=text,
        target_type=target_type,
        limit=limit
    )
    
    return templates.TemplateResponse("similarity/results.html", {
        "request": request,
        "source_doc": None,
        "doc_type": None,
        "similar_docs": similar_docs,
        "target_type": target_type,
        "limit": limit,
        "search_text": text
    })
```

---

## 10. 디렉토리 구조

```
templates/
├── base.html                    # 공통 레이아웃
├── macros.html                  # 재사용 매크로
├── index.html                   # 메인 페이지
├── cases/
│   ├── list.html               # 판례 목록
│   └── detail.html             # 판례 상세
├── constitutional/
│   ├── list.html               # 헌재결정례 목록
│   └── detail.html             # 헌재결정례 상세
├── interpretations/
│   ├── list.html               # 법령해석례 목록
│   └── detail.html             # 법령해석례 상세
└── similarity/
    └── results.html            # 유사 검색 결과
```

